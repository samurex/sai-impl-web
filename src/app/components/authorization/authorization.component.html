
<div *ngIf="!resource$">
  <h1>{{ (authorizationData$ | async)?.accessNeedGroup?.label }}</h1>
  <h2>{{ (authorizationData$ | async)?.accessNeedGroup?.description }}</h2>

  <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="example-tree">
    <!-- This is the tree node template for leaf nodes -->
    <!-- There is inline padding applied to this node using styles.
      This padding value depends on the mat-icon-button width. -->
    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
      <mat-card>
        <mat-card-title>{{node.shapeTree.label}}</mat-card-title>
        <mat-card-content>{{node.label}}</mat-card-content>
      </mat-card>
    </mat-tree-node>
    <!-- This is the tree node template for expandable nodes -->
    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
      <div class="mat-tree-node">
        <mat-card>
          <mat-card-title>{{node.shapeTree.label}}</mat-card-title>
          <mat-card-content>{{node.label}}</mat-card-content>
        </mat-card>
      </div>
      <!-- There is inline padding applied to this div using styles.
          This padding value depends on the mat-icon-button width.  -->
      <div class="mat-nested-tree-node"
           role="group">
        <ng-container matTreeNodeOutlet></ng-container>
      </div>
    </mat-nested-tree-node>
  </mat-tree>
  <div *ngIf="dataSource.data.length">
    <button mat-raised-button color="primary" (click)="authorize()">{{'APP.CTA-AUTHORIZED' | translate}}</button>
    <button mat-raised-button color="warn" (click)="authorize(false)">{{'APP.CTA-DENY' | translate}}</button>
  </div>
</div>
<div *ngIf="(resource$ | async) as resource">
  <mat-card>
    <mat-card-title>{{ resource.shapeTree.label }}</mat-card-title>
    <mat-card-content>
      {{ resource.label }}
      <sai-access-modes-selector (change)="accessChanged($event.mode)"></sai-access-modes-selector>
      <mat-list>
        <mat-list-item *ngFor="let child of resource.children">
          {{child.shapeTree.label}} ({{ child.count }})
          <sai-access-modes-selector [extras]="['add']" (change)="childChanged(child.shapeTree.id, $event.mode)"></sai-access-modes-selector>
        </mat-list-item>
      </mat-list>
    </mat-card-content>
  </mat-card>
  <mat-selection-list #agents>
    <mat-list-option *ngFor="let agent of potentialAccessGrantees$ | async" [value]="agent.id">
      {{agent.label}}
    </mat-list-option>
  </mat-selection-list>
  <button [disabled]="!agents.selectedOptions.selected.length || !shareData.accessMode.length" mat-raised-button color="primary" (click)="share(agents.selectedOptions.selected)">{{'APP.CTA-SHARE' | translate}}</button>
  <mat-list>
    <mat-list-item *ngFor="let agent of existingAccessGrantees$ | async">
      {{ agent.label }}
      <mat-icon>arrow_forward</mat-icon>
    </mat-list-item>
  </mat-list>
</div>

<!--<div>-->
<!--  <sai-app-view expanded="true" [application]="applications$ | async">-->

<!--  </sai-app-view>-->

<!--</div>-->

<!--
<ng-template #noClientId>
  <div class="form-container">
    <h3 class="missing-client-warn">{{'APP.AUTH-CLIENT-ID-MISSING' | translate}}</h3>
    <form [routerLink]="'/authorize'" [queryParams]="{client_id: clientIdInput}">
      <mat-form-field class="full-width-input">
        <mat-label>{{'APP.AUTH-APP-ID' | translate}}</mat-label>
        <input matInput required [(ngModel)]="clientIdInput" [ngModelOptions]="{standalone: true}">
        <mat-error>{{'APP.AUTH-APP-ID-REQUIRED' | translate}}</mat-error>
      </mat-form-field>
      <button mat-raised-button>{{'APP.CTA-SEARCH' | translate}}</button>
    </form>
  </div>
</ng-template> -->
